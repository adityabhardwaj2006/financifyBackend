{% extends "base.html" %}

{% block title %}Upload Balance Sheet — auditX{% endblock %}

{% block content %}
<div class="upload-section">
    <div class="card">
        <div class="card-header-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="40" height="40">
                <path d="M3 3h18v18H3z" rx="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 9h18M9 3v18" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M13 13h4M13 17h4" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.5"/>
            </svg>
        </div>
        <h2>Upload Your Balance Sheet</h2>
        <p class="subtitle">
            Upload a financial statement in XLSX, CSV, or JSON format. auditX will automatically
            detect the layout, extract standardised values, and calculate key financial ratios.
        </p>

        <form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data" class="upload-form">
            <div class="file-input-wrapper" id="drop-zone">
                <label for="file" class="file-label">
                    <svg class="file-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="48" height="48">
                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="14,2 14,8 20,8" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="12" y1="18" x2="12" y2="12" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="9,15 12,12 15,15" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="file-label-text">
                        <span id="file-name" class="file-name">Drag & drop or click to choose a file</span>
                        <span class="file-hint">XLSX, CSV, JSON, TXT — up to 16 MB</span>
                    </span>
                </label>
                <input type="file" id="file" name="file" accept=".xlsx,.xls,.csv,.json,.txt" required>
            </div>

            <button type="submit" class="btn btn-primary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                    <line x1="11" y1="8" x2="11" y2="14" stroke-linecap="round"/>
                    <line x1="8" y1="11" x2="14" y2="11" stroke-linecap="round"/>
                </svg>
                Analyze Statement
            </button>
        </form>

        <div class="features">
            <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="20" height="20">
                    <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
                </svg>
                Capabilities
            </h3>
            <div class="features-grid">
                <div class="feature-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="24" height="24">
                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                        <polyline points="14,2 14,8 20,8"/>
                        <path d="M9 13h6M9 17h3"/>
                    </svg>
                    <div>
                        <strong>Smart XLSX Parsing</strong>
                        <span>Auto-detects Schedule III, T-account, and generic layouts</span>
                    </div>
                </div>
                <div class="feature-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="24" height="24">
                        <circle cx="11" cy="11" r="8"/>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                    </svg>
                    <div>
                        <strong>Semantic Matching</strong>
                        <span>Understands 200+ financial label variations</span>
                    </div>
                </div>
                <div class="feature-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="24" height="24">
                        <path d="M12 20V10M18 20V4M6 20v-4"/>
                    </svg>
                    <div>
                        <strong>30+ Ratios</strong>
                        <span>Liquidity, profitability, leverage, efficiency & more</span>
                    </div>
                </div>
                <div class="feature-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="24" height="24">
                        <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                        <polyline points="22,4 12,14.01 9,11.01"/>
                    </svg>
                    <div>
                        <strong>Confidence Scoring</strong>
                        <span>Every mapping is auditable with confidence %</span>
                    </div>
                </div>
                <div class="feature-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="24" height="24">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                    <div>
                        <strong>Fuzzy Logic</strong>
                        <span>Handles typos, abbreviations, and word-order variations</span>
                    </div>
                </div>
                <div class="feature-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="24" height="24">
                        <rect x="2" y="2" width="20" height="20" rx="5"/>
                        <path d="M16 8l-8 8M8 8l8 8" stroke-opacity="0"/>
                        <path d="M8 12h8"/>
                        <path d="M12 8v8"/>
                    </svg>
                    <div>
                        <strong>Multi-Format</strong>
                        <span>XLSX, CSV, JSON, and plain text files</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="sample-formats">
            <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="20" height="20">
                    <path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/>
                    <rect x="8" y="2" width="8" height="4" rx="1"/>
                </svg>
                Supported Formats
            </h3>

            <div class="formats-grid">
                <div class="format-example">
                    <h4>
                        <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="16" height="16">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <line x1="3" y1="9" x2="21" y2="9"/>
                            <line x1="9" y1="3" x2="9" y2="21"/>
                        </svg>
                        XLSX / Excel
                    </h4>
                    <pre>Schedule III, T-account, or
any two-column layout — 
auditX auto-detects the format.</pre>
                </div>

                <div class="format-example">
                    <h4>
                        <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="16" height="16">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                        </svg>
                        CSV
                    </h4>
                    <pre>Label,Value
Profit After Tax,500000
Current Assets,3450000
Net Sales,4200000</pre>
                </div>

                <div class="format-example">
                    <h4>
                        <svg viewBox="0 0 24 24" fill="none" stroke="#00e5a0" stroke-width="1.5" width="16" height="16">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                        </svg>
                        JSON
                    </h4>
                    <pre>{
  "Profit After Tax": 500000,
  "Current Assets": 3450000,
  "Net Sales": 4200000
}</pre>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const fileInput = document.getElementById('file');
    const fileName = document.getElementById('file-name');
    const dropZone = document.getElementById('drop-zone');

    fileInput.addEventListener('change', function(e) {
        if (e.target.files.length > 0) {
            fileName.textContent = e.target.files[0].name;
            dropZone.classList.add('file-selected');
        } else {
            fileName.textContent = 'Drag & drop or click to choose a file';
            dropZone.classList.remove('file-selected');
        }
    });

    ['dragenter', 'dragover'].forEach(evt => {
        dropZone.addEventListener(evt, e => {
            e.preventDefault();
            dropZone.classList.add('drag-over');
        });
    });

    ['dragleave', 'drop'].forEach(evt => {
        dropZone.addEventListener(evt, e => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
        });
    });

    dropZone.addEventListener('drop', e => {
        const dt = e.dataTransfer;
        fileInput.files = dt.files;
        fileInput.dispatchEvent(new Event('change'));
    });
</script>
{% endblock %}
